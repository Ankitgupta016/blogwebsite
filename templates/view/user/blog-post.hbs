<!-- blog-post.hbs -->

<html>

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta property="image" content="img/apple-touch-icon.png" />
  <meta name="author" content="Ankit gupta" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#000000" />

  <link rel="icon" type="image/x-icon" href="/img/favicon.ico" />
  <script src="https://kit.fontawesome.com/780468c39f.js" crossorigin="anonymous"></script>

  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css?family=Poppins:400,700&display=swap" rel="stylesheet" />

  <link type="text/css" href="/css/bootstrap.min.css" rel="stylesheet" />
  <script src="/jq/jquery.js" type="text/javascript"></script>
  <link type="text/css" rel="stylesheet" href="/css/style.css" />
  <link type="text/css" rel="stylesheet" href="/css/respo.css" />
  <style>
    #postContent::first-letter {
      text-transform: capitalize;
      font-size: 4rem;
      color: red
    }
  </style>

  <title>{{post.title}}</title>
  <script>function myFunction() {
      const loader =
        document.getElementsByClassName("loader")[0]; loader.style.display =
          "none";
    }
    </script>
</head>

<body onload="myFunction()">
  <!-- PreLoader -->
  <div class="loader">
    <div class="loader-inner">
      <div class="circle"></div>
    </div>
  </div>
  <!-- PreLoader Ends -->

  {{>navbar}}
  <div class="mt-4 pt-5"></div>
  <div class="container-fliud">

    <div class="ps-5 d-flex align-items-center text-white" style="background: #f60; height:105px;">
      <h1>{{post.title}}</h1>
    </div>
    <p class="pt-3 px-md-5" style="font-size: inherit; opacity: 0.6;color: #aab8c2; font-style:italic">Posted by Admin</p>
    <p class="py-1 px-md-5" style="font-size: inherit; opacity: 0.6;color: #aab8c2;">Published on: {{post.Date}}</p>
    <div class="container w-md-50 text-start">
    </div>
  </div>
  <section class="container">
    <div class="row">
      <div class="col-md-8">

        <div>

          <div class="card mb-4 border-0">
      <img class=" mb-3"  src="/userImage/{{post.image}}" class="card-img-top" alt="Image 1"  />

            <p id="postContent">{{post.content}}</p>
            <!-- HTML template -->
            <div class="like-dislike-container d-flex">
              <form action="/blog/{{post._id}}" method="POST">
                <button  class="" id="formsumbitlike">
                  <i class="fas fa-thumbs-up like-button"></i>
                </button>
                <span>{{post.likes}}</span>
              </form>
              <form action="/blog/{{post._id}}" method="POST">
                <button type="submit" class="">
                  <i class="fas fa-thumbs-down dislike-button"></i>
                </button>
                <span>{{post.dislikes}}</span>
              </form>
            </div>

          </div>
          <div class="all-comment-container border border-1 p-3">
            <!-- Display existing comments -->
            {{#each comments}}
            <div class="show-comment mb-4 d-flex align-items-center">

              <img src="/userImages/{{this.user.image}}" alt="{{this.user.image}}" width="40" height="40"
                class="rounded-circle" 
                title="{{this.user.email}}" style="cursor: pointer;"/>
              <div class="show ps-2">
                <d class="username" style="font-weight: normal !important;  font-family: 'Roboto';">{{this.user.name}}
                </d>
                <div class="show">{{this.content}}</div>
              </div>
            </div>
            {{/each}}

            <!-- Comment submission form -->
            <div class="post-comment ">
              <form  id="commentForm">
              <input hidden type="text" name="post_id" value="{{post._id}}">
                <input class="  w-100 mt-4 mb-3 py-4 px-2" type="text" name="comment" style="height: 60px;"
                  placeholder="Add a comment..." required />
                <button type="submit" class=" btn btn-primary d-flex ms-auto  ">Submit</button>
              </form>
              <p class="com-status text-success"></p>
            </div>
          </div>

        </div>

      </div>

      <div class="col-md-4">
        <div class="card mb-4">
          <div class="card-body">
            <h4 class="card-title">About Me</h4>
            <p class="card-text">I'm a passionate blogger sharing my thoughts
              and ideas with the world.</p>
          </div>
        </div>
       
        <div class="card mb-4">
          <div class="card-body">
            <h4 class="card-title">Categories</h4>
            <ul class="list-group">
              <li class="list-group-item">Technology</li>
              <li class="list-group-item">Travel</li>
              <li class="list-group-item">Food</li>
              <li class="list-group-item">Lifestyle</li>
              <li class="list-group-item">Stock market</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <hr style="color: #aab8c2;" />
    <div class="share-buttons">
      <div class="social-btn">
        <a href="https://www.facebook.com/sharer/sharer.php?u=https://your-website.com/blog-post-1" target="_blank"
          class="p-1"><i class="fa-brands fa-facebook-f"></i></a>
        <a href="https://twitter.com/intent/tweet?url=https://your-website.com/blog-post-1&text=Check%20out%20this%20blog%20post"
          target="_blank" class="p-1"><i class="fa-brands fa-twitter"></i></a>
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://your-website.com/blog-post-1&title=Blog%20Post%20Title&summary=Check%20out%20this%20blog%20post&source=Your%20Website"
          target="_blank" class="p-1"><i class="fa-brands fa-linkedin-in"></i></a>
        <a href="#" class="text-danger instagram-button" data-title="{{post.title}}" data-image="img/img-10.png"><i
            class="fa-brands fa-instagram"></i></a>
      </div>

    </div>
    <hr style="color: #aab8c2;" />

    <!-- blog-post.hbs -->
    <div id="recentPostsSection">
      <h4>Recent Posts</h4>
      <div class="d-md-flex justify-content-between border-1 border">
        {{#each recentPosts}}
        <div class="col-md-4 p-3">
          <div class="card">
             <img src="/userImage/{{image}}" class="card-img-top" alt="Image " />
            <div class="card-body">
              <h5 class="card-title">{{title}}</h5>
              <p class="card-text">{{content}}</p>
              <div class="d-flex justify-content-between">
                <a class="card-link text-decoration-none text-dark">{{Date}}</a><!-- Use the field directly -->
                <a href="/blog/{{_id}}" class="card-link">Read More</a>
              </div>

            </div>
          </div>
        </div>
        {{/each}}
      </div>
    </div>

  </section>

  <!-- Add additional HTML and styling as needed -->
  {{>footer}}
  <script>
    

    document.addEventListener("DOMContentLoaded", function () {
      const cardTextElements = document.getElementsByClassName("card-text");
      Array.from(cardTextElements).forEach(function (element) {
        const content =
          element.textContent; const maxLength = 100; if (content.length >
            maxLength) { element.textContent = content.slice(0, maxLength) + "..."; }
      });
    });

$(document).ready(function () {
  $("#commentForm").submit(function (event) {
    event.preventDefault();
    var formdata = $(this).serialize();

    $.ajax({
      url: "/comment/{{post._id}}",
      type: "POST",
      data: formdata,
      success: function (data) {
        $(".com-status").text(data.msg);
        setTimeout(function () {
          $(".com-status").text("");
        }, 5000);
      },
    });
   
   
    $(this).trigger("reset");
  });
});

  </script>

  <script src="/js/index.js"></script>

</body>

</html>